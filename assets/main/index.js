window.__require=function e(t,i,o){function a(l,r){if(!i[l]){if(!t[l]){var c=l.split("/");if(c=c[c.length-1],!t[c]){var s="function"==typeof __require&&__require;if(!r&&s)return s(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+l+"'")}l=c}var d=i[l]={exports:{}};t[l][0].call(d.exports,function(e){return a(t[l][1][e]||e)},d,d.exports,e,t,i,o)}return i[l].exports}for(var n="function"==typeof __require&&__require,l=0;l<o.length;l++)a(o[l]);return a}({Crate:[function(e,t,i){"use strict";cc._RF.push(t,"4b5c5A2KcdA6IXpY0hwsIjV","Crate");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=e("./Player"),r=e("../Utils/Music"),c=e("../Global"),s=e("./Floor"),d=cc._decorator,u=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveDirection=0,t.collisionLeft=0,t.collisionRight=0,t.collisionBottom=0,t.speedX=128,t.speedY=0,t.maxSpeedY=512,t.gravity=780,t.onGround=!0,t.moveSfx=new cc.AudioSource,t.loadedObject=[],t}var i;return a(t,e),i=t,t.prototype.start=function(){this.size=cc.size(this.node.width,this.node.height),this.tag=0,this.moveSfx.clip=c.default.SFX.MOVE_STONE,this.moveSfx.loop=!0},t.prototype.onDestroy=function(){this.moveSfx.isPlaying&&this.moveSfx.stop()},t.prototype.moveLoadedObjects=function(e,t){var o=this;e.loadedObject.forEach(function(e){e instanceof i?(1==o.moveDirection&&0==e.collisionRight||-1==o.moveDirection&&0==e.collisionLeft)&&(e.node.x+=t,e.loadedObject&&o.moveLoadedObjects(e,t)):e instanceof l.default&&o.moveDirection!=e.collisionDirectionX&&(e.node.x+=t)})},t.prototype.update=function(e){cc.isValid(this.node)||this.moveSfx.stop(),this.onGround?0!=this.moveDirection?-1==this.moveDirection&&!this.collisionLeft||1==this.moveDirection&&!this.collisionRight?(this.node.x+=this.moveDirection*this.speedX*e,this.moveLoadedObjects(this,this.moveDirection*this.speedX*e),this.moveSfx.isPlaying||this.moveSfx.play()):this.moveSfx.isPlaying&&this.moveSfx.stop():0==this.moveDirection&&this.moveSfx.isPlaying&&this.moveSfx.stop():(this.moveSfx.isPlaying&&this.moveSfx.stop(),Math.abs(this.speedY-this.gravity*e)<=this.maxSpeedY?this.speedY-=this.gravity*e:this.speedY=-this.maxSpeedY,this.node.y+=this.speedY*e)},t.prototype.onCollisionEnter=function(e,t){switch(e.tag){case 0:case 1:c.default.isDebug&&console.info("hit player");var o=e.world.aabb,a=t.world.aabb,n=t.world.preAabb.clone();if(0==n.x&&0==n.y&&0==n.width&&0==n.height)return;n.x=a.x,cc.Intersection.rectRect(n,o)?(n.x=t.world.preAabb.x,this.moveDirection<0&&n.xMin>o.xMax&&a.yMax>o.yMin?(this.node.x+=Math.abs(o.xMax-a.xMin),this.collisionLeft+=1,c.default.isDebug&&console.info("114")):this.moveDirection>0&&n.xMax<o.xMin&&a.yMax>o.yMin&&(this.node.x-=Math.abs(a.xMax-o.xMin),this.collisionRight+=1,c.default.isDebug&&console.info("121"))):(console.log("129"),n.x=t.world.preAabb.x,n.xMin>=o.xMax||a.xMin>=o.xMax?(c.default.isDebug&&(console.log("132"),console.log("\u649e\u5de6\u8fb9\u5899-\u4ece\u7a7a-\u7bb1")),this.node.x+=Math.abs(o.xMax-a.xMin),this.collisionLeft+=1):n.xMax<=o.xMin||a.xMax<=o.xMin?(this.node.x-=Math.abs(a.xMax-o.xMin),this.collisionRight+=1):this.speedY<0&&n.yMin>o.yMax&&(this.node.y+=Math.abs(o.yMax-a.yMin),(e instanceof s.default||e instanceof i)&&(this.onGround=!0),e instanceof i&&e.loadedObject.push(this),this.speedY=0,0==e.tag&&r.default.playLandStone()))}},t.prototype.onCollisionExit=function(e,t){switch(e.tag){case 0:var i=e.world.aabb,o=t.world.aabb,a=t.world.preAabb.clone();a.x=o.x,cc.Intersection.rectRect(a,i)?(a.xMax<=i.xMin&&(this.collisionRight-=1),a.xMin>=i.xMax&&(this.collisionLeft-=1)):o.yMin==i.yMax&&1==this.onGround&&(o.xMax<i.xMin?(this.node.x+=i.xMin-o.xMax,this.collisionRight+=1):i.xMax<o.xMin&&(this.node.x-=o.xMin-i.xMax,this.collisionLeft+=1),this.onGround=!1)}},i=n([u],t)}(cc.BoxCollider));i.default=h,cc._RF.pop()},{"../Global":"Global","../Utils/Music":"Music","./Floor":"Floor","./Player":"Player"}],EndLevel:[function(e,t,i){"use strict";cc._RF.push(t,"58b2fAF3JJDbbC2rnR1/F70","EndLevel");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,r=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.init=function(){this.node.stopAllActions(),this.node.opacity=0,"0"==this.node.name&&this.node.runAction(cc.fadeIn(6))},t.prototype.onCollisionEnter=function(e,t){switch(t.node.name){case"0":this.node.parent.getChildByName("1").runAction(cc.fadeIn(3));break;case"1":this.node.parent.getChildByName("2").runAction(cc.fadeIn(3));break;case"2":this.node.parent.getChildByName("3").runAction(cc.fadeIn(3));break;case"3":this.node.parent.getChildByName("4").runAction(cc.fadeIn(3))}},n([r],t)}(cc.Component));i.default=c,cc._RF.pop()},{}],Floor:[function(e,t,i){"use strict";cc._RF.push(t,"2609crMrYtGP4OeyYmkrvCv","Floor");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,r=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.start=function(){this.size=cc.size(this.node.width,this.node.height),this.tag=0},t.prototype.update=function(){},t.prototype.onCollisionEnter=function(){},n([r],t)}(cc.BoxCollider));i.default=c,cc._RF.pop()},{}],Global:[function(e,t,i){"use strict";cc._RF.push(t,"e81d1UxbV5M9JZwXh54RiLc","Global"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return e.loadConfig=function(){var e=this;return new Promise(function(t,i){cc.loader.loadRes("config",function(o,a){o?i():(e.config=a.json,t())})})},e.loadANIMATIONS=function(){var e=this;return new Promise(function(t,i){Promise.all([e.loadSingleANIMATIONS("JOSH"),e.loadSingleANIMATIONS("ROSIE"),e.loadSingleANIMATIONS("HEART")]).then(function(){t()}).catch(function(){return i()})})},e.loadSingleANIMATIONS=function(e){var t=this;return new Promise(function(i,o){cc.loader.loadRes("Animations/"+e,cc.SpriteAtlas,function(a,n){if(a)o(a);else{var l=n.getSpriteFrames();t.initAnimation(e,l),i()}})})},e.initAnimation=function(t,i){switch(t){case"JOSH":e.ANIMATIONS.JOSH.animStand=cc.AnimationClip.createWithSpriteFrames([i[0],i[1],i[2]],5),e.ANIMATIONS.JOSH.animStand.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.JOSH.animWalk=cc.AnimationClip.createWithSpriteFrames([i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10]],10),e.ANIMATIONS.JOSH.animWalk.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.JOSH.animPush=cc.AnimationClip.createWithSpriteFrames([i[11],i[12],i[13],i[14],i[15],i[16]],10),e.ANIMATIONS.JOSH.animPush.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.JOSH.animJump=cc.AnimationClip.createWithSpriteFrames([i[17],i[18],i[19]],10),e.ANIMATIONS.JOSH.animJump.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.JOSH.animFall=cc.AnimationClip.createWithSpriteFrames([i[20],i[21],i[22]],5),e.ANIMATIONS.JOSH.animFall.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.JOSH.animDie=cc.AnimationClip.createWithSpriteFrames([i[23],i[24],i[25],i[26],i[27],i[28],i[29]],10),e.ANIMATIONS.JOSH.animPushStand=cc.AnimationClip.createWithSpriteFrames([i[11]],10),e.ANIMATIONS.JOSH.animPushStand.wrapMode=cc.WrapMode.Loop;break;case"ROSIE":e.ANIMATIONS.ROSIE.animStand=cc.AnimationClip.createWithSpriteFrames([i[0],i[1],i[2]],5),e.ANIMATIONS.ROSIE.animStand.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.ROSIE.animWalk=cc.AnimationClip.createWithSpriteFrames([i[3],i[4],i[5]],10),e.ANIMATIONS.ROSIE.animWalk.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.ROSIE.animPush=cc.AnimationClip.createWithSpriteFrames([i[6],i[7],i[8]],10),e.ANIMATIONS.ROSIE.animPush.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.ROSIE.animJump=cc.AnimationClip.createWithSpriteFrames([i[9],i[10],i[11]],10),e.ANIMATIONS.ROSIE.animJump.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.ROSIE.animFall=cc.AnimationClip.createWithSpriteFrames([i[12],i[13],i[14]],5),e.ANIMATIONS.ROSIE.animFall.wrapMode=cc.WrapMode.Loop,e.ANIMATIONS.ROSIE.animDie=cc.AnimationClip.createWithSpriteFrames([i[15],i[16],i[17],i[18],i[19],i[20]],10),e.ANIMATIONS.ROSIE.animPushStand=cc.AnimationClip.createWithSpriteFrames([i[6]],10),e.ANIMATIONS.ROSIE.animPushStand.wrapMode=cc.WrapMode.Loop;break;case"HEART":e.ANIMATIONS.HEART=cc.AnimationClip.createWithSpriteFrames(i,10)}},e.loadBGM=function(){var e=this;return new Promise(function(t,i){cc.loader.loadResDir("Audios/BGM",cc.AudioClip,function(o,a){if(o)i();else{for(var n=0,l=a;n<l.length;n++){var r=l[n];e.BGM[r.name]=r}t()}})})},e.loadSFX=function(){var e=this;return new Promise(function(t,i){cc.loader.loadResDir("Audios/SFX",cc.AudioClip,function(o,a){if(o)i();else{for(var n=0,l=a;n<l.length;n++){var r=l[n];e.SFX[r.name]=r}t()}})})},e.loadBACKGROUNDS=function(){var e=this;return new Promise(function(t,i){cc.loader.loadResDir("Backgrounds",cc.SpriteFrame,function(o,a){if(o)i();else{for(var n=0,l=a;n<l.length;n++){var r=l[n];e.BACKGROUNDS[r.name]=new cc.SpriteFrame(r.getTexture())}t()}})})},e.loadTIELSET=function(){var e=this;return new Promise(function(t,i){cc.loader.loadRes("Maps/TILESET",cc.Texture2D,function(o,a){o?(console.log(o),i()):(e.TILESET=a,t())})})},e.loadOBJECTS=function(){var e=this;return new Promise(function(t,i){cc.loader.loadResDir("Objects",cc.SpriteFrame,function(o,a){if(o)console.log(o),i();else{for(var n=0,l=a;n<l.length;n++){var r=l[n];e.OBJECTS[r.name]=r}t()}})})},e.loadWEATHERS=function(){var e=this;return new Promise(function(t,i){cc.loader.loadResDir("Weathers",cc.SpriteFrame,function(o,a){if(o)i();else{for(var n=0,l=a;n<l.length;n++){var r=l[n];e.WEATHERS[r.name]=r}t()}})})},e.loadSavedLevel=function(){this.savedLevel=cc.sys.localStorage.getItem("level")},e.ANIMATIONS={JOSH:{},ROSIE:{},HEART:void 0},e.BGM={},e.SFX={},e.BACKGROUNDS={},e.OBJECTS={},e.WEATHERS={},e.isDebug=!1,e.defaultBGM="GOLDBERG",e.levelIndex=19,e.tutorialState={dead:!1,reborn:!1,nearHole:!1,jumpOverHole:!1,sawRosie:!1,nearSpike:!1,jumpOverSpike:!1,init:function(){this.dead=!1,this.reborn=!1,this.nearHole=!1,this.jumpOverHole=!1,this.sawRosie=!1,this.nearSpike=!1,this.jumpOverSpike=!1}},e}();i.default=o,cc._RF.pop()},{}],Main:[function(e,t,i){"use strict";cc._RF.push(t,"d04d8Pu8k9N+qQ+ZMkCa9Pl","Main");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,r=l.ccclass,c=(l.property,e("./Global")),s=e("./Utils/Music"),d=e("./Objects/Player"),u=e("./Objects/Spike"),h=e("./Objects/Crate"),f=e("./Objects/Floor"),p=e("./Smoke"),y=e("./Levels/EndLevel"),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.windowLights=[],t.lampLights=[],t.lampLightTime=0,t}return a(t,e),t.prototype.setActive=function(e,t){this.buttonLayer.getChildByName("SWITCH_J2R").active=!e,this.buttonLayer.getChildByName("SWITCH_R2J").active=!t},t.prototype.start=function(){var e=this;cc.director.getCollisionManager().enabled=!0,c.default.isDebug&&(cc.director.getCollisionManager().enabledDrawBoundingBox=!0,cc.director.getCollisionManager().enabledDebugDraw=!0),this.homeLayer=this.node.getChildByName("homeLayer"),this.tieldMapLayer=this.node.getChildByName("tieldMapLayer"),this.objectsLayer=this.node.getChildByName("objectsLayer"),this.smokeLayer=this.node.getChildByName("smokeLayer"),this.buttonLayer=this.node.getChildByName("buttonLayer"),this.hintLayer=this.node.getChildByName("hintLayer"),this.endTitle=this.node.getChildByName("endTitle"),Promise.all([c.default.loadConfig(),c.default.loadBGM(),c.default.loadANIMATIONS(),c.default.loadSFX(),c.default.loadBACKGROUNDS(),c.default.loadTIELSET(),c.default.loadOBJECTS(),c.default.loadWEATHERS()]).then(function(){c.default.loadSavedLevel(),s.default.playBGM("GOLDBERG"),e.bindTouchListener(),e.bindButtonListener(),e.goHome(),e.initSelectLevel(),e.initHeart()})},t.prototype.update=function(){var e=this;if(c.default.isRestart&&(this.loadScence(!0),c.default.isRestart=!1),c.default.isExit)this.goHome(),c.default.isExit=!1;else if(c.default.isVictory&&c.default.JOSH.onGround&&c.default.ROSIE.onGround&&!c.default.JOSH.dead&&!c.default.ROSIE.dead){c.default.JOSH.isControled=!1,c.default.ROSIE.isControled=!1,c.default.JOSH.node.opacity=255,c.default.ROSIE.node.opacity=255,c.default.JOSH.moveDirection=0,c.default.ROSIE.moveDirection=0;var t=c.default.JOSH.node.position.x,i=c.default.ROSIE.node.position.x;t>i?(c.default.JOSH.node.scaleX=-1,c.default.ROSIE.node.scaleX=1):(c.default.JOSH.node.scaleX=1,c.default.ROSIE.node.scaleX=-1),this.heartNode.active=!0,this.heartNode.setPosition((t+i)/2,c.default.JOSH.node.position.y+20),s.default.playKiss();var o=this.heartNode.getComponent(cc.Animation).play("heart");this.scheduleOnce(function(){if(c.default.levelIndex>=19)e.tieldMapLayer.active=!1,e.objectsLayer.active=!1,e.hintLayer.active=!1,e.buttonLayer.active=!1,e.node.getChildByName("endTitle").active=!1,e.heartNode.active=!1,e.smokeLayer.getComponent(p.default).showEnd().then(function(){e.buttonLayer.active=!0,e.buttonLayer.getChildByName("RESTART").active=!1});else{if(c.default.levelIndex++,c.default.levelIndex>c.default.savedLevel&&[1,4,7,10,13,15,18,19].indexOf(c.default.levelIndex)>=0)switch(cc.sys.localStorage.setItem("level",c.default.levelIndex),c.default.savedLevel=c.default.levelIndex,c.default.levelIndex){case 1:e.homeLayer.getChildByName("levels").getChildByName("I").getComponent(cc.Label).string=c.default.config.levelsProperties[1].title;break;case 4:e.homeLayer.getChildByName("levels").getChildByName("II").getComponent(cc.Label).string=c.default.config.levelsProperties[4].title;break;case 7:e.homeLayer.getChildByName("levels").getChildByName("III").getComponent(cc.Label).string=c.default.config.levelsProperties[7].title;break;case 10:e.homeLayer.getChildByName("levels").getChildByName("IV").getComponent(cc.Label).string=c.default.config.levelsProperties[10].title;break;case 13:e.homeLayer.getChildByName("levels").getChildByName("V").getComponent(cc.Label).string=c.default.config.levelsProperties[13].title;break;case 15:e.homeLayer.getChildByName("levels").getChildByName("VI").getComponent(cc.Label).string=c.default.config.levelsProperties[15].title;break;case 18:e.homeLayer.getChildByName("levels").getChildByName("VII").getComponent(cc.Label).string=c.default.config.levelsProperties[18].title;break;case 19:e.homeLayer.getChildByName("levels").getChildByName("VIII").getComponent(cc.Label).string=c.default.config.levelsProperties[19].title2}e.loadScence()}},o.duration),c.default.isVictory=!1}else if(c.default.JOSH&&c.default.ROSIE&&c.default.JOSH.node&&c.default.ROSIE.node)switch(c.default.levelIndex){case 0:c.default.ROSIE.node.x>360&&!c.default.tutorialState.jumpOverSpike?(c.default.tutorialState.jumpOverSpike=!0,this.hintLayer.getComponent(cc.Label).string="\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u76f8\u7231\u4e86"):c.default.ROSIE.node.x>128&&!c.default.tutorialState.nearSpike?(c.default.tutorialState.nearSpike=!0,this.hintLayer.getComponent(cc.Label).string="\u4f60\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e9b\u5c16\u523a"):c.default.JOSH.node.x>512&&!c.default.tutorialState.sawRosie?(c.default.tutorialState.sawRosie=!0,c.default.ROSIE.node.active=!0,c.default.ROSIE.isControled=!1,this.buttonLayer.getChildByName("SWITCH_J2R").active=!0,this.hintLayer.getComponent(cc.Label).string="\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u9047\u89c1\u4e86\u4f60\uff0c\u4f60\u5411\u6211\u8d70\u6765"):c.default.JOSH.node.x>320&&!c.default.tutorialState.jumpOverHole?(c.default.tutorialState.jumpOverHole=!0,this.hintLayer.getComponent(cc.Label).string="\u6211\u559c\u6b22\u63a8\u8fd9\u4e9b\u7bb1\u5b50"):c.default.tutorialState.reborn&&c.default.JOSH.node.x>96&&-304==c.default.JOSH.node.y&&!c.default.tutorialState.nearHole?(c.default.tutorialState.nearHole=!0,this.hintLayer.getComponent(cc.Label).string="\u6211\u5b66\u4f1a\u8df3\u8dc3\uff0c\u907f\u514d\u8ba9\u81ea\u5df1\u53d7\u4f24"):c.default.tutorialState.dead&&!c.default.tutorialState.reborn&&(c.default.tutorialState.reborn=!0,c.default.JOSH.canJump=!0,this.hintLayer.getComponent(cc.Label).string="\u4e0d\u5c0f\u5fc3\u6454\u5012\u53d7\u4e86\u4f24");break;case 4:case 5:case 6:Math.abs(c.default.JOSH.node.y-c.default.ROSIE.node.y)<1&&Math.abs(c.default.JOSH.node.x-c.default.ROSIE.node.x)>16?c.default.ROSIE.moveDirection=c.default.JOSH.node.x>c.default.ROSIE.node.x?1:-1:c.default.ROSIE.moveDirection=0;break;case 18:var a=Math.sqrt(Math.pow(c.default.JOSH.node.x-c.default.ROSIE.node.x,2)+Math.pow(c.default.JOSH.node.y-c.default.ROSIE.node.y,2));this.tieldMapLayer.opacity=a>300?0:a>50?128*(1-(a-50)/250):128*(2-a/50);break;default:this.tieldMapLayer.opacity=255}},t.prototype.goHome=function(){this.tieldMapLayer.active=!1,this.objectsLayer.active=!1,this.hintLayer.active=!1,this.hintLayer.getComponent(cc.Label).string="",this.buttonLayer.active=!1,this.buttonLayer.getChildByName("SWITCH_J2R").active=!1,this.buttonLayer.getChildByName("SWITCH_R2J").active=!1,this.buttonLayer.getChildByName("RESTART").active=!1,this.smokeLayer.active=!1,this.node.getChildByName("endTitle").active=!1,this.homeLayer.active=!0,this.homeLayer.getChildByName("menus").active=!0,this.homeLayer.getChildByName("levels").active=!1},t.prototype.initSelectLevel=function(){c.default.savedLevel>=1&&(this.homeLayer.getChildByName("levels").getChildByName("I").getComponent(cc.Label).string=c.default.config.levelsProperties[1].title),c.default.savedLevel>=4&&(this.homeLayer.getChildByName("levels").getChildByName("II").getComponent(cc.Label).string=c.default.config.levelsProperties[4].title),c.default.savedLevel>=7&&(this.homeLayer.getChildByName("levels").getChildByName("III").getComponent(cc.Label).string=c.default.config.levelsProperties[7].title),c.default.savedLevel>=10&&(this.homeLayer.getChildByName("levels").getChildByName("IV").getComponent(cc.Label).string=c.default.config.levelsProperties[10].title),c.default.savedLevel>=13&&(this.homeLayer.getChildByName("levels").getChildByName("V").getComponent(cc.Label).string=c.default.config.levelsProperties[13].title),c.default.savedLevel>=15&&(this.homeLayer.getChildByName("levels").getChildByName("VI").getComponent(cc.Label).string=c.default.config.levelsProperties[15].title),c.default.savedLevel>=18&&(this.homeLayer.getChildByName("levels").getChildByName("VII").getComponent(cc.Label).string=c.default.config.levelsProperties[18].title),c.default.savedLevel>=19&&(this.homeLayer.getChildByName("levels").getChildByName("VIII").getComponent(cc.Label).string=c.default.config.levelsProperties[19].title2)},t.prototype.bindButtonListener=function(){var e=this;this.buttonLayer.getChildByName("SWITCH_J2R").on(cc.Node.EventType.TOUCH_START,function(){e.setActive(!0,!1),s.default.playSwitch(),c.default.ROSIE.isControled=!0,c.default.JOSH.isControled=!1,c.default.JOSH.moveDirection=0}),this.buttonLayer.getChildByName("SWITCH_R2J").on(cc.Node.EventType.TOUCH_START,function(){e.setActive(!1,!0),s.default.playSwitch(),c.default.ROSIE.isControled=!1,c.default.JOSH.isControled=!0,c.default.ROSIE.moveDirection=0}),this.buttonLayer.getChildByName("RESTART").on(cc.Node.EventType.TOUCH_START,function(){c.default.isRestart=!0}),this.buttonLayer.getChildByName("EXIT").on(cc.Node.EventType.TOUCH_START,function(){c.default.isExit=!0}),this.homeLayer.getChildByName("menus").getChildByName("start").on(cc.Node.EventType.TOUCH_START,function(){c.default.levelIndex=0,e.loadScence()}),this.homeLayer.getChildByName("menus").getChildByName("selectLevel").on(cc.Node.EventType.TOUCH_START,function(){e.homeLayer.getChildByName("menus").active=!1,e.homeLayer.getChildByName("levels").active=!0,e.buttonLayer.active=!0}),this.homeLayer.getChildByName("levels").getChildByName("I").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("I").getComponent(cc.Label).string&&(c.default.levelIndex=1,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("II").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("II").getComponent(cc.Label).string&&(c.default.levelIndex=4,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("III").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("III").getComponent(cc.Label).string&&(c.default.levelIndex=7,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("IV").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("IV").getComponent(cc.Label).string&&(c.default.levelIndex=10,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("V").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("V").getComponent(cc.Label).string&&(c.default.levelIndex=13,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("VI").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("VI").getComponent(cc.Label).string&&(c.default.levelIndex=15,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("VII").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("VII").getComponent(cc.Label).string&&(c.default.levelIndex=18,e.loadScence())}),this.homeLayer.getChildByName("levels").getChildByName("VIII").on(cc.Node.EventType.TOUCH_START,function(){"???"!=e.homeLayer.getChildByName("levels").getChildByName("VIII").getComponent(cc.Label).string&&(c.default.levelIndex=19,e.loadScence())})},t.prototype.bindTouchListener=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){c.default.JOSH&&c.default.ROSIE&&t.getLocationX()>e.node.width/2&&(c.default.JOSH._isControled&&c.default.JOSH.jump(),c.default.ROSIE._isControled&&c.default.ROSIE.jump())}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){c.default.JOSH&&c.default.ROSIE&&(t.getStartLocation().x<e.node.width/2&&t.getLocation().x-t.getStartLocation().x>c.default.config.touchMoveThreshold?(c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=1),c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=1)):t.getStartLocation().x<e.node.width/2&&t.getLocation().x-t.getStartLocation().x<-c.default.config.touchMoveThreshold?(c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=-1),c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=-1)):(c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=0),c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=0)))}),this.node.on(cc.Node.EventType.TOUCH_END,function(){c.default.JOSH&&c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=0),c.default.ROSIE&&c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=0)}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){c.default.JOSH&&c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=0),c.default.ROSIE&&c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=0)}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){c.default.isDebug&&t.keyCode==cc.macro.KEY.space&&(c.default.levelIndex++,c.default.levelIndex>19&&(c.default.levelIndex=0),e.loadScence()),t.keyCode==cc.macro.KEY.w&&(c.default.JOSH._isControled&&c.default.JOSH.jump(),c.default.ROSIE._isControled&&c.default.ROSIE.jump()),t.keyCode==cc.macro.KEY.a&&(c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=-1),c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=-1)),t.keyCode==cc.macro.KEY.d&&(c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=1),c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=1))}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){e.keyCode!=cc.macro.KEY.a&&e.keyCode!=cc.macro.KEY.d||(c.default.JOSH._isControled&&(c.default.JOSH.moveDirection=0),c.default.ROSIE._isControled&&(c.default.ROSIE.moveDirection=0))})},t.prototype.loadScence=function(e){var t=this;void 0===e&&(e=!1),this.homeLayer.active=!1,e||(this.unscheduleAllCallbacks(),this.windowLights=[],this.lampLights=[],this.tieldMapLayer.destroyAllChildren()),this.objectsLayer.destroyAllChildren(),this.heartNode.active=!1,cc.loader.loadRes("Maps/"+c.default.config.levelsProperties[c.default.levelIndex].map,function(i,o){switch(i&&console.log(i),t.loadObjects(o),e||(t.initEnvironment(),t.loadFloors(o),t.makeHouses(o),t.makeHills(o),t.makeTrees(o),t.makeGarbageCans(o),t.makeLamps(o),t.loadTiledMaps(o),t.schedule(t.updateWindowLights,.125),t.schedule(t.updateLampLights,.125),s.default.playBGM(c.default.config.levelsProperties[c.default.levelIndex].bgm)),c.default.levelIndex){case 0:t.buttonLayer.getChildByName("SWITCH_R2J").active=!1,t.buttonLayer.getChildByName("RESTART").active=!1,c.default.JOSH.isControled=!0,e||c.default.tutorialState.init(),t.buttonLayer.getChildByName("SWITCH_J2R").active=c.default.tutorialState.sawRosie,c.default.ROSIE.node.active=c.default.tutorialState.sawRosie,e||(c.default.JOSH.canJump=!1,t.hintLayer.getComponent(cc.Label).string="2022\u5e74\uff0c\u6211\u53ea\u8eab\u6765\u5230\u4e86\u65b0\u7684\u56fd\u5ea6");break;case 1:t.hintLayer.getComponent(cc.Label).string="\u6211\u63d0\u9192\u81ea\u5df1\uff0c\u4e0d\u8981\u4ece\u592a\u9ad8\u5904\u6389\u843d",t.buttonLayer.getChildByName("RESTART").active=!0,t.buttonLayer.getChildByName("SWITCH_J2R").active=!0,t.buttonLayer.getChildByName("SWITCH_R2J").active=!1,c.default.JOSH.isControled=!0;break;case 2:case 3:t.hintLayer.getComponent(cc.Label).string="",t.buttonLayer.getChildByName("RESTART").active=!0,t.buttonLayer.getChildByName("SWITCH_J2R").active=!0,t.buttonLayer.getChildByName("SWITCH_R2J").active=!1,c.default.JOSH.isControled=!0;break;case 4:case 5:case 6:c.default.JOSH.isControled=!0,c.default.ROSIE.isControled=!1,c.default.ROSIE.speedX=48,t.buttonLayer.getChildByName("RESTART").active=!0,t.buttonLayer.getChildByName("SWITCH_J2R").active=!1,t.buttonLayer.getChildByName("SWITCH_R2J").active=!1;break;case 7:case 8:case 9:t.buttonLayer.getChildByName("RESTART").active=!0,c.default.JOSH.isControled=!0,c.default.ROSIE.isControled=!0;break;case 10:case 11:case 12:t.buttonLayer.getChildByName("RESTART").active=!0,c.default.JOSH.isControled=!0,c.default.ROSIE.isControled=!0,c.default.ROSIE.dir=-1;break;case 13:case 14:t.buttonLayer.getChildByName("RESTART").active=!0,c.default.JOSH.isControled=!0,c.default.ROSIE.isControled=!1,c.default.ROSIE.moveDirection=1,c.default.ROSIE.dir=1,c.default.ROSIE.speedX=48;break;case 15:case 16:case 17:t.buttonLayer.getChildByName("RESTART").active=!0,t.buttonLayer.getChildByName("SWITCH_J2R").active=!0,t.buttonLayer.getChildByName("SWITCH_R2J").active=!1,c.default.JOSH.isControled=!0,c.default.ROSIE.isControled=!1,c.default.JOSH.canJump=!1;break;case 18:t.buttonLayer.getChildByName("RESTART").active=!0,t.buttonLayer.getChildByName("SWITCH_J2R").active=!0,t.buttonLayer.getChildByName("SWITCH_R2J").active=!1,c.default.JOSH.isControled=!0,c.default.ROSIE.isControled=!1,c.default.JOSH.canJump=!0;break;case 19:t.buttonLayer.getChildByName("RESTART").active=!0,t.buttonLayer.getChildByName("SWITCH_J2R").active=!1,t.buttonLayer.getChildByName("SWITCH_R2J").active=!1,c.default.ROSIE.isControled=!0,c.default.JOSH.isControled=!1,c.default.JOSH.node.scaleX=-1}}),e?19==c.default.levelIndex&&this.node.getChildByName("endTitle").children.forEach(function(e){e.getComponent(y.default).init()}):[0,1,4,7,10,13,15,18,19].indexOf(c.default.levelIndex)>=0&&(this.tieldMapLayer.active=!1,this.objectsLayer.active=!1,this.hintLayer.active=!1,this.buttonLayer.active=!1,this.node.getChildByName("endTitle").active=!1,19!=c.default.levelIndex?this.smokeLayer.getComponent(p.default).show(c.default.levelIndex).then(function(){t.tieldMapLayer.active=!0,t.objectsLayer.active=!0,t.hintLayer.active=!0,t.buttonLayer.active=!0,t.smokeLayer.active=!1}):this.smokeLayer.getComponent(p.default).show(19.1).then(function(){t.smokeLayer.getComponent(p.default).show(19.2).then(function(){t.tieldMapLayer.active=!0,t.objectsLayer.active=!0,t.hintLayer.active=!0,t.buttonLayer.active=!0,t.smokeLayer.active=!1,t.node.getChildByName("endTitle").active=!0,t.node.getChildByName("endTitle").children.forEach(function(e){e.getComponent(y.default).init()})})}))},t.prototype.initEnvironment=function(){var e=c.default.config.levelsProperties[c.default.levelIndex].weather;this.buildFrame(c.default.WEATHERS[e],null,c.default.config.weatherProperties[e].WEATHER,"weather"),this.buildFrame(c.default.WEATHERS.SHADING,null,c.default.config.weatherProperties[e].SHADING,"shading"),this.buildFrame(c.default.WEATHERS.TEX,null,c.default.config.weatherProperties[e].TEX,"tex")},t.prototype.initHeart=function(){this.heartNode=new cc.Node,this.heartNode.active=!1,this.heartNode.addComponent(cc.Sprite),this.heartNode.addComponent(cc.Animation).addClip(c.default.ANIMATIONS.HEART,"heart"),this.node.addChild(this.heartNode)},t.prototype.loadFloors=function(e){for(var t=0,i=e.json.floors.rect;t<i.length;t++){var o=i[t],a=new cc.Node;a.setPosition(o.x+o.w/2,-o.h/2-o.y),a.width=o.w,a.height=o.h,a.addComponent(f.default),this.tieldMapLayer.addChild(a)}},t.prototype.loadTiledMaps=function(e){for(var t=0,i=e.json.Maps.TILESET;t<i.length;t++){var o=i[t],a=new cc.SpriteFrame(c.default.TILESET);a.setRect(cc.rect(o.tx,o.ty,32,32)),this.buildFrame(a,o,255,"tieldMap")}},t.prototype.makeTrees=function(e){for(var t=0;t<3;t++)if(e.json.Backgrounds.hasOwnProperty("tree"+t))for(var i=0,o=e.json.Backgrounds["tree"+t];i<o.length;i++){var a=o[i];this.buildFrame(c.default.BACKGROUNDS["tree"+t],a,255,"tree");var n="";switch(c.default.config.levelsProperties[c.default.levelIndex].season){case"DEFAULT":n="_leaves";break;case"AUTUMN":n="_leaves_color";break;case"WINTER":n="_snow"}this.buildFrame(c.default.BACKGROUNDS["tree"+t+n],a,255,"tree_suffix")}},t.prototype.makeHills=function(e){for(var t=0;t<2;t++)if(e.json.Backgrounds.hasOwnProperty("hill"+t))for(var i=0,o=e.json.Backgrounds["hill"+t];i<o.length;i++){var a=o[i];this.buildFrame(c.default.BACKGROUNDS["hill"+t],a,255,"hill"),"WINTER"==c.default.config.levelsProperties[c.default.levelIndex].season&&this.buildFrame(c.default.BACKGROUNDS["hill"+t+"_snow"],a,255,"hill_snow")}},t.prototype.makeGarbageCans=function(e){if(e.json.Backgrounds.hasOwnProperty("can"))for(var t=0,i=e.json.Backgrounds.can;t<i.length;t++){var o=i[t];this.buildFrame(c.default.BACKGROUNDS.can,o,255,"can"),"WINTER"==c.default.config.levelsProperties[c.default.levelIndex].season&&this.buildFrame(c.default.BACKGROUNDS.can_snow,o,255,"can_snow")}},t.prototype.makeLamps=function(e){if(e.json.Backgrounds.hasOwnProperty("lamp"))for(var t=0,i=e.json.Backgrounds.lamp;t<i.length;t++){var o=i[t];this.buildFrame(c.default.BACKGROUNDS.lamp,o,255,"lamp"),"WINTER"==c.default.config.levelsProperties[c.default.levelIndex].season&&this.buildFrame(c.default.BACKGROUNDS.lamp_snow,o,255,"lamp_snow");var a=new cc.Node;a.anchorX=0,a.anchorY=1,a.setPosition(o.x-44,41-o.y),a.addComponent(cc.Sprite).spriteFrame="TWILIGHT"==c.default.config.levelsProperties[c.default.levelIndex].weather?c.default.BACKGROUNDS.lamp_light_white:c.default.BACKGROUNDS.lamp_light,a.opacity=128,this.lampLights.push(a),this.tieldMapLayer.addChild(a,c.default.config.zIndex.lamp_light)}},t.prototype.makeHouses=function(e){for(var t=0;t<3;t++)if(e.json.Backgrounds.hasOwnProperty("house"+t))for(var i=0,o=e.json.Backgrounds["house"+t];i<o.length;i++){var a=o[i];this.buildFrame(c.default.BACKGROUNDS["house"+t],a,64,"house"),this.buildFrame(c.default.BACKGROUNDS["house"+t+"_light"],a,128,"house_light");for(var n=0,l=c.default.config.windowOffsetByHouse[t];n<l.length;n++){var r=l[n],s=new cc.Node;s.anchorX=0,s.anchorY=1,s.setPosition(a.x+r[1],-(a.y+r[2])),s.addComponent(cc.Sprite).spriteFrame=c.default.BACKGROUNDS["window_light"+r[0]],s.opacity=128,s.active=!1,this.windowLights.push(s),this.tieldMapLayer.addChild(s,c.default.config.zIndex.house_light)}}},t.prototype.updateWindowLights=function(){for(var e=Math.floor(6*Math.random());e>0;){var t=this.windowLights[Math.floor(Math.random()*this.windowLights.length)];t.active=!t.active,e--}},t.prototype.updateLampLights=function(){var e=this;this.lampLightTime+=1,this.lampLightTime>=32&&(this.lampLightTime=0),this.lampLights.forEach(function(t){t.opacity=96+32*Math.cos(e.lampLightTime/16*Math.PI)})},t.prototype.buildFrame=function(e,t,i,o){void 0===t&&(t=null),void 0===i&&(i=255),void 0===o&&(o=null);var a=new cc.Node;a.anchorX=0,a.anchorY=1,t&&a.setPosition(t.x,-t.y),a.addComponent(cc.Sprite).spriteFrame=e,a.opacity=i,this.tieldMapLayer.addChild(a,c.default.config.zIndex[o])},t.prototype.loadObjects=function(e){var t=e.json.Objects;for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];switch(i){case"JOSH":case"ROSIE":(m=new cc.Node).setPosition(o.x+16,-16-o.y),m.addComponent(cc.Sprite),m.opacity=127;var a=m.addComponent(cc.Animation);for(var n in c.default.ANIMATIONS[i])c.default.ANIMATIONS[i].hasOwnProperty(n)&&a.addClip(c.default.ANIMATIONS[i][n],n);var l=m.addComponent(d.default);l.playerName=i,c.default[i]=l,this.objectsLayer.addChild(m,c.default.config.zIndex.player);break;case"CRATE":for(var r=0,s=o;r<s.length;r++){var f=s[r];(m=new cc.Node).setPosition(f.x+16,-16-f.y),m.addComponent(cc.Sprite).spriteFrame=c.default.OBJECTS.CRATE,m.addComponent(h.default),this.objectsLayer.addChild(m,c.default.config.zIndex.crate)}break;case"SPIKES":for(var p=0,y=o;p<y.length;p++){var m;f=y[p],(m=new cc.Node).setPosition(f.x+16,-16-f.y),m.addComponent(cc.Sprite).spriteFrame=c.default.OBJECTS.SPIKES,m.addComponent(u.default),this.objectsLayer.addChild(m,c.default.config.zIndex.spike)}break;default:console.log("unknown obj ",i)}}},n([r],t)}(cc.Component);i.default=m,cc._RF.pop()},{"./Global":"Global","./Levels/EndLevel":"EndLevel","./Objects/Crate":"Crate","./Objects/Floor":"Floor","./Objects/Player":"Player","./Objects/Spike":"Spike","./Smoke":"Smoke","./Utils/Music":"Music"}],Music:[function(e,t,i){"use strict";cc._RF.push(t,"07e173qV+VEa6xE9ZAJ9iWk","Music"),Object.defineProperty(i,"__esModule",{value:!0});var o=e("../Global"),a=function(){function e(){}return e.playBGM=function(e){if(e=e||o.default.defaultBGM,this.musicStatus.BGM.name!=e){var t=cc.audioEngine.playMusic(o.default.BGM[e],!0);this.musicStatus.BGM.id=t,this.musicStatus.BGM.name=e}},e.playJump=function(e){cc.audioEngine.play(o.default.SFX["JUMP_"+e],!1,.5)},e.playDie=function(e){cc.audioEngine.play(o.default.SFX["DIE_"+e],!1,.25)},e.playLandStone=function(){cc.audioEngine.play(o.default.SFX.LAND_STONE,!1,.25)},e.playLandPlayer=function(e){cc.audioEngine.play(o.default.SFX["LAND_"+e],!1,.5)},e.playKiss=function(){cc.audioEngine.play(o.default.SFX.KISS,!1,.25)},e.playSwitch=function(){cc.audioEngine.play(o.default.SFX.SWITCH,!1,.25)},e.playMove=function(e){if(cc.audioEngine.getState(this.musicStatus[e].id)!=cc.audioEngine.AudioState.PLAYING)if("MOVE1"==this.musicStatus[e].name){var t=cc.audioEngine.play(o.default.SFX["MOVE2_"+e],!1,.5);this.musicStatus[e].id=t,this.musicStatus[e].name="MOVE2"}else t=cc.audioEngine.play(o.default.SFX["MOVE1_"+e],!1,.5),this.musicStatus[e].id=t,this.musicStatus[e].name="MOVE1"},e.musicStatus={BGM:{id:void 0,name:void 0},JOSH:{id:void 0,name:void 0},ROSIE:{id:void 0,name:void 0},STONE:{id:void 0}},e}();i.default=a,cc._RF.pop()},{"../Global":"Global"}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"09fa8vblmZBPZ350DmAlCIG","Player");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=e("../Utils/Music"),r=e("../Global"),c=e("./Crate"),s=cc._decorator,d=s.ccclass,u=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveDirection=0,t.collisionDirectionX=0,t.collisionRemain=0,t.speedX=128,t.speedY=0,t.maxSpeedY=512,t.gravity=780,t.onGround=!0,t.dead=!1,t.dir=1,t.canJump=!0,t}return a(t,e),Object.defineProperty(t.prototype,"isControled",{get:function(){return this._isControled},set:function(e){this.dead||(this._isControled=e,this.node.opacity=e?255:127)},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.size=cc.size(16,24),this.offset=cc.v2(0,-4),this.tag=1},t.prototype.jump=function(){this.onGround&&this.canJump&&(this.playAnim("animJump"),l.default.playJump(this.playerName),this.onGround=!1,this.jumpedY=this.node.y,this.speedY=300,this.pushedCrate&&(this.pushedCrate.moveDirection=0,0!=this.moveDirection&&(this.collisionDirectionX=this.moveDirection)))},t.prototype.die=function(){if(!this.dead){r.default.isVictory=!1,this.dead=!0,l.default.playDie(this.playerName);var e=this.playAnim("animDie");this.scheduleOnce(function(){r.default.isRestart=!0},e.duration),this==r.default.JOSH&&0==r.default.levelIndex&&(r.default.tutorialState.dead=!0)}},t.prototype.playAnim=function(e){var t=this.node.getComponent(cc.Animation);if(!t.getAnimationState(e).isPlaying)return t.play(e)},t.prototype.update=function(e){if(this.dead){if(this.node.opacity<=0)return;var t=this.node.opacity-192*e;return t<0&&(t=0),void(this.node.opacity=t)}if(1!=this.moveDirection&&-1!=this.moveDirection||(this.node.scaleX=this.moveDirection*this.dir),this.onGround)if(1==this.moveDirection||-1==this.moveDirection){if(this.pushedCrate){if(this.playAnim("animPush"),this.pushedCrate&&this.pushedCrate.onGround){if(console.log(this.pushedCrate),this.dir*this.moveDirection==1&&this.pushedCrate.collisionRight>0)return void(this.collisionDirectionX=1);if(this.dir*this.moveDirection==-1&&this.pushedCrate.collisionLeft>0)return void(this.collisionDirectionX=-1)}}else this.playAnim("animWalk");this.dir*this.moveDirection!=this.collisionDirectionX&&(this.pushedCrate&&!this.pushedCrate.onGround||(this.collisionDirectionX=0,this.node.x+=this.dir*this.moveDirection*this.speedX*e,l.default.playMove(this.playerName)))}else this.playAnim("animStand");else this.speedY>0?this.playAnim("animJump"):this.playAnim("animFall"),Math.abs(this.speedY-this.gravity*e)<=this.maxSpeedY?this.speedY-=this.gravity*e:this.speedY=-this.maxSpeedY,this.node.y+=this.speedY*e,0!=this.moveDirection&&this.dir*this.moveDirection!=this.collisionDirectionX&&(this.collisionDirectionX=0,this.node.x+=this.dir*this.moveDirection*this.speedX*e)},t.prototype.onCollisionEnter=function(e,t){switch(e.tag){case 0:this.collisionRemain+=1;var i=t.world.aabb,o=t.world.preAabb.clone(),a=e.world.aabb,n=e.world.preAabb.clone();if(0==o.x&&0==o.y&&0==o.width&&0==o.height)return;if(e instanceof c.default&&0==e.onGround&&o.yMax<n.yMin)return void this.die();o.x=i.x,cc.Intersection.rectRect(o,a)?(console.log("collision occurs on x-axis"),o.x=t.world.preAabb.x,this.dir*this.moveDirection<0&&o.xMin>a.xMax&&i.yMin<a.yMax?(this.node.x+=Math.abs(a.xMax-i.xMin),e instanceof c.default?(e.moveDirection=this.dir*this.moveDirection,e.speedX=this.speedX,this.collisionDirectionX=e.collisionLeft>0?-1:0,this.pushedCrate=e,console.log("193")):(this.collisionDirectionX=-1,this.pushedCrate=null)):this.dir*this.moveDirection>0&&o.xMax<a.xMin&&i.yMin<a.yMax&&(this.node.x-=Math.abs(i.xMax-a.xMin),e instanceof c.default?(e.moveDirection=this.dir*this.moveDirection,e.speedX=this.speedX,this.collisionDirectionX=e.collisionRight>0?1:0,this.pushedCrate=e,console.log("208")):(this.collisionDirectionX=1,this.pushedCrate=null))):(o.x=t.world.preAabb.x,o.xMin>=a.xMax||i.xMin>=a.xMax?(this.node.x+=Math.abs(a.xMax-i.xMin),this.collisionDirectionX=-1):o.xMax<=a.xMin||i.xMax<=a.xMin?(this.node.x-=Math.abs(i.xMax-a.xMin),this.collisionDirectionX=1):this.speedY>0&&o.yMax<a.yMin?(this.node.y+=Math.abs(i.yMax-a.yMin),this.speedY=0):this.speedY<0&&o.yMin>a.yMax&&(this.node.y+=Math.abs(a.yMax-i.yMin),this.onGround=!0,this.speedY=0,this.jumpedY-this.node.y>112?this.die():l.default.playLandPlayer(this.playerName),e instanceof c.default&&e.loadedObject.push(this)));break;case 1:r.default.isVictory=!0;break;case 2:return void this.die()}},t.prototype.onCollisionExit=function(e,t){if(e instanceof c.default){e.moveDirection=0;var i=e.loadedObject.indexOf(this);i>-1&&e.loadedObject.splice(i,1),this.pushedCrate=null}switch(e.tag){case 0:this.collisionRemain-=1;var o=e.world.aabb,a=e.world.preAabb.clone(),n=t.world.aabb,l=t.world.preAabb.clone();l.x=n.x,cc.Intersection.rectRect(l,o)?l.yMin<a.yMax&&(l.xMax<=a.xMin||l.xMin>=a.xMax)&&0==this.collisionRemain&&(this.collisionDirectionX=0):n.yMin==o.yMax&&1==this.onGround&&0==this.collisionRemain&&(this.onGround=!1,this.jumpedY=this.node.y);break;case 1:r.default.isVictory=!1}},n([d],t)}(cc.BoxCollider));i.default=u,cc._RF.pop()},{"../Global":"Global","../Utils/Music":"Music","./Crate":"Crate"}],Smoke:[function(e,t,i){"use strict";cc._RF.push(t,"ed575RLCeFLupgPGoaXueNT","Smoke");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=e("./Global"),r=cc._decorator,c=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.start=function(){this.node.active=!1},t.prototype.show=function(e){var t=this;switch(this.node.getChildByName("smokeSprite").getComponent(cc.Sprite).spriteFrame=l.default.BACKGROUNDS["smoke"+Math.floor(3*Math.random())],e){case 0:case 1:case 4:case 7:case 10:case 13:case 15:case 18:this.node.getChildByName("titleSprite").getComponent(cc.Label).string=l.default.config.levelsProperties[e].title;break;case 19.1:this.node.getChildByName("titleSprite").getComponent(cc.Label).string=l.default.config.levelsProperties[19].title1;break;case 19.2:this.node.getChildByName("titleSprite").getComponent(cc.Label).string=l.default.config.levelsProperties[19].title2}return new Promise(function(e){t.node.getChildByName("smokeSprite").x=-60,t.node.active=!0,t.node.runAction(cc.sequence(cc.fadeIn(1),cc.delayTime(2),cc.fadeOut(1))),t.scheduleOnce(function(){e()},4)})},t.prototype.showEnd=function(){var e=this,t="\u4eb2\u7231\u7684\u79c0\u4e91\uff0c\n\n\u5728\u8fc7\u53bb\u7684\u4e00\u5e74\uff0c\u6211\u4eec\u6536\u83b7\u4e86\u8bb8\u591a\u5171\u540c\u7ecf\u5386\uff0c\n\u65e2\u4e00\u8d77\u5206\u4eab\u8fc7\u7231\u60c5\u7684\u751c\u871c\uff0c\u4f46\u4e5f\u6709\u8fc7\u4e89\u5435\u3002\n\u4e0d\u8fc7\u6700\u540e\uff0c\u6211\u4eec\u7684\u611f\u60c5\u90fd\u662f\u53d8\u5f97\u8d8a\u6765\u8d8a\u597d\u3002\n\u6211\u662f\u4e2a\u5c0f\u5fc3\u773c\u7684\u4eba\uff0c\u8c22\u8c22\u4f60\u5bf9\u6211\u4e00\u76f4\u4ee5\u6765\n\u7684\u5305\u5bb9\u3002\u613f\u6211\u4eec\u643a\u624b\u6c38\u8fdc\u8d70\u4e0b\u53bb\u3002\n\nIch liebe dich & Alles Gute zum Geburtstag\nDeine Zijian";this.node.getChildByName("smokeSprite").getComponent(cc.Sprite).spriteFrame=l.default.BACKGROUNDS.all,this.node.getChildByName("titleSprite").getComponent(cc.Label).string="";for(var i=function(i){o.scheduleOnce(function(){e.node.getChildByName("titleSprite").getComponent(cc.Label).string+=t.charAt(i)},.25*i)},o=this,a=0;a<t.length;a++)i(a);return new Promise(function(i){e.node.getChildByName("smokeSprite").x=-60,e.node.active=!0,e.node.runAction(cc.fadeIn(1)),e.scheduleOnce(function(){i()},.25*t.length)})},t.prototype.update=function(e){this.node.getChildByName("smokeSprite").x+=64*e},n([c],t)}(cc.Component));i.default=s,cc._RF.pop()},{"./Global":"Global"}],Spike:[function(e,t,i){"use strict";cc._RF.push(t,"4c8fdZj201FvIm7OgB6zjem","Spike");var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),n=this&&this.__decorate||function(e,t,i,o){var a,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(l=(n<3?a(l):n>3?a(t,i,l):a(t,i))||l);return n>3&&l&&Object.defineProperty(t,i,l),l};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,r=l.ccclass,c=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.start=function(){this.size=cc.size(32,24),this.offset=cc.v2(0,-4),this.tag=2},t.prototype.update=function(){},n([r],t)}(cc.BoxCollider));i.default=c,cc._RF.pop()},{}]},{},["Global","EndLevel","Main","Crate","Floor","Player","Spike","Smoke","Music"]);
//# sourceMappingURL=index.js.map
